{
    "teacher_model_name": "./models/bert-base-uncased",
    "student_model_name": "./models/distilbert-base-uncased",
    "dataset_path": "./dataset",
    "train_batch_size": 32,
    "eval_batch_size": 32,
    "num_train_epochs": 3,
    "weight_decay": 0.01,
    "dir_name": "./results",
    "rank": 8,
    "lora_alpha": 16,
    "lora_dropout": 0.05,
    "teacher_learning_rate": 5e-05,
    "student_learning_rate": 0.0005,
    "task": "mrpc",
    "peft": "lora",
    "model_family": "bert",
    "seed": 42,
    "teacher_fft_results": {
        "eval_loss": 0.41491904854774475,
        "eval_accuracy": 0.8529411764705882,
        "eval_f1": 0.8983050847457628,
        "eval_runtime": 3.9215,
        "eval_samples_per_second": 104.041,
        "eval_steps_per_second": 3.315,
        "epoch": 3.0,
        "log_history": [
            {
                "loss": 0.5772,
                "grad_norm": 3.6143829822540283,
                "learning_rate": 3.5507246376811596e-05,
                "epoch": 0.8695652173913043,
                "step": 100
            },
            {
                "eval_loss": 0.4062930941581726,
                "eval_accuracy": 0.8088235294117647,
                "eval_f1": 0.8682432432432433,
                "eval_runtime": 3.4316,
                "eval_samples_per_second": 118.896,
                "eval_steps_per_second": 3.788,
                "epoch": 1.0,
                "step": 115
            },
            {
                "loss": 0.3278,
                "grad_norm": 5.689990997314453,
                "learning_rate": 2.101449275362319e-05,
                "epoch": 1.7391304347826086,
                "step": 200
            },
            {
                "eval_loss": 0.4470430910587311,
                "eval_accuracy": 0.8284313725490197,
                "eval_f1": 0.8863636363636362,
                "eval_runtime": 3.6964,
                "eval_samples_per_second": 110.377,
                "eval_steps_per_second": 3.517,
                "epoch": 2.0,
                "step": 230
            },
            {
                "loss": 0.189,
                "grad_norm": 5.6450276374816895,
                "learning_rate": 6.521739130434783e-06,
                "epoch": 2.608695652173913,
                "step": 300
            },
            {
                "eval_loss": 0.41491904854774475,
                "eval_accuracy": 0.8529411764705882,
                "eval_f1": 0.8983050847457628,
                "eval_runtime": 3.8043,
                "eval_samples_per_second": 107.246,
                "eval_steps_per_second": 3.417,
                "epoch": 3.0,
                "step": 345
            },
            {
                "train_runtime": 311.8331,
                "train_samples_per_second": 35.288,
                "train_steps_per_second": 1.106,
                "total_flos": 2895274053181440.0,
                "train_loss": 0.33375163976696953,
                "epoch": 3.0,
                "step": 345
            },
            {
                "eval_loss": 0.41491904854774475,
                "eval_accuracy": 0.8529411764705882,
                "eval_f1": 0.8983050847457628,
                "eval_runtime": 3.9215,
                "eval_samples_per_second": 104.041,
                "eval_steps_per_second": 3.315,
                "epoch": 3.0,
                "step": 345
            }
        ],
        "train": {
            "train_time": 311.8331,
            "trainable_params_count": 109.483778,
            "memory_allocated": [
                1345.473024,
                1345.473024,
                1345.473024
            ],
            "memory_reserved": [
                11922.30912,
                11922.30912,
                11922.30912
            ]
        }
    },
    "teacher_lora_results": {
        "eval_loss": 0.37327679991722107,
        "eval_accuracy": 0.8431372549019608,
        "eval_f1": 0.888888888888889,
        "eval_runtime": 4.0463,
        "eval_samples_per_second": 100.833,
        "eval_steps_per_second": 3.213,
        "epoch": 3.0,
        "log_history": [
            {
                "loss": 0.6067,
                "grad_norm": 2.347057819366455,
                "learning_rate": 0.000355072463768116,
                "epoch": 0.8695652173913043,
                "step": 100
            },
            {
                "eval_loss": 0.4942389726638794,
                "eval_accuracy": 0.7892156862745098,
                "eval_f1": 0.8594771241830065,
                "eval_runtime": 3.7474,
                "eval_samples_per_second": 108.876,
                "eval_steps_per_second": 3.469,
                "epoch": 1.0,
                "step": 115
            },
            {
                "loss": 0.4791,
                "grad_norm": 1.4557331800460815,
                "learning_rate": 0.00021014492753623187,
                "epoch": 1.7391304347826086,
                "step": 200
            },
            {
                "eval_loss": 0.4050087034702301,
                "eval_accuracy": 0.8284313725490197,
                "eval_f1": 0.8821548821548822,
                "eval_runtime": 3.4121,
                "eval_samples_per_second": 119.575,
                "eval_steps_per_second": 3.81,
                "epoch": 2.0,
                "step": 230
            },
            {
                "loss": 0.3856,
                "grad_norm": 1.8148378133773804,
                "learning_rate": 6.521739130434782e-05,
                "epoch": 2.608695652173913,
                "step": 300
            },
            {
                "eval_loss": 0.37327679991722107,
                "eval_accuracy": 0.8431372549019608,
                "eval_f1": 0.888888888888889,
                "eval_runtime": 3.9645,
                "eval_samples_per_second": 102.912,
                "eval_steps_per_second": 3.279,
                "epoch": 3.0,
                "step": 345
            },
            {
                "train_runtime": 225.8278,
                "train_samples_per_second": 48.727,
                "train_steps_per_second": 1.528,
                "total_flos": 2905295334359040.0,
                "train_loss": 0.47067992168924083,
                "epoch": 3.0,
                "step": 345
            },
            {
                "eval_loss": 0.37327679991722107,
                "eval_accuracy": 0.8431372549019608,
                "eval_f1": 0.888888888888889,
                "eval_runtime": 4.0463,
                "eval_samples_per_second": 100.833,
                "eval_steps_per_second": 3.213,
                "epoch": 3.0,
                "step": 345
            }
        ],
        "train": {
            "train_time": 225.8278,
            "trainable_params_count": 0.29645,
            "memory_allocated": [
                1354.771456,
                1354.771456,
                1354.771456
            ],
            "memory_reserved": [
                9934.209024,
                9934.209024,
                9934.209024
            ]
        }
    },
    "student_lora_results": {
        "eval_loss": 1.3120999336242676,
        "eval_accuracy": 0.8431372549019608,
        "eval_f1": 0.891156462585034,
        "eval_runtime": 1.426,
        "eval_samples_per_second": 286.118,
        "eval_steps_per_second": 9.117,
        "epoch": 3.0,
        "log_history": [
            {
                "loss": 0.8214,
                "grad_norm": 1.0501798391342163,
                "learning_rate": 0.000355072463768116,
                "epoch": 0.8695652173913043,
                "step": 100
            },
            {
                "eval_loss": 1.074212670326233,
                "eval_accuracy": 0.7549019607843137,
                "eval_f1": 0.8397435897435896,
                "eval_runtime": 1.6194,
                "eval_samples_per_second": 251.945,
                "eval_steps_per_second": 8.028,
                "epoch": 1.0,
                "step": 115
            },
            {
                "loss": 0.5851,
                "grad_norm": 2.57485032081604,
                "learning_rate": 0.00021014492753623187,
                "epoch": 1.7391304347826086,
                "step": 200
            },
            {
                "eval_loss": 1.2904434204101562,
                "eval_accuracy": 0.8259803921568627,
                "eval_f1": 0.8826446280991737,
                "eval_runtime": 1.9318,
                "eval_samples_per_second": 211.206,
                "eval_steps_per_second": 6.73,
                "epoch": 2.0,
                "step": 230
            },
            {
                "loss": 0.4798,
                "grad_norm": 2.020380973815918,
                "learning_rate": 6.521739130434782e-05,
                "epoch": 2.608695652173913,
                "step": 300
            },
            {
                "eval_loss": 1.3120999336242676,
                "eval_accuracy": 0.8431372549019608,
                "eval_f1": 0.891156462585034,
                "eval_runtime": 2.4009,
                "eval_samples_per_second": 169.939,
                "eval_steps_per_second": 5.415,
                "epoch": 3.0,
                "step": 345
            },
            {
                "train_runtime": 111.5269,
                "train_samples_per_second": 98.667,
                "train_steps_per_second": 3.093,
                "total_flos": 1482672432955392.0,
                "train_loss": 0.6027046093042346,
                "epoch": 3.0,
                "step": 345
            },
            {
                "eval_loss": 1.3120999336242676,
                "eval_accuracy": 0.8431372549019608,
                "eval_f1": 0.891156462585034,
                "eval_runtime": 1.426,
                "eval_samples_per_second": 286.118,
                "eval_steps_per_second": 9.117,
                "epoch": 3.0,
                "step": 345
            }
        ],
        "train": {
            "train_time": 111.5269,
            "trainable_params_count": 0.739586,
            "memory_allocated": [
                1183.184384,
                1183.184384,
                1183.184384
            ],
            "memory_reserved": [
                5630.85312,
                5630.85312,
                5630.85312
            ]
        }
    }
}